<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LineSpeak - English Practice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <!-- Tailwind 配置 -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#165DFF',
            secondary: '#36CFC9',
            accent: '#722ED1',
            neutral: {
              100: '#F5F7FA',
              200: '#E5E6EB',
              300: '#C9CDD4',
              400: '#86909C',
              500: '#4E5969',
              600: '#272E3B',
              700: '#1D2129',
            }
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .content-auto {
        content-visibility: auto;
      }
      .text-shadow {
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .sentence-hover {
        @apply hover:bg-primary/5 dark:hover:bg-primary/10 transition-colors duration-200;
      }
      .sentence-active {
        @apply bg-primary/10 dark:bg-primary/20;
      }
      .progress-bar {
        @apply h-1 bg-neutral-200 dark:bg-neutral-500 rounded-full overflow-hidden;
      }
      .progress-fill {
        @apply h-full bg-primary transition-all duration-300 w-0;
      }
    }
  </style>
</head>
<body class="font-inter bg-neutral-100 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-100 transition-colors duration-300 min-h-screen">
  <!-- 顶部导航 -->
  <header class="bg-white dark:bg-neutral-600 shadow-sm sticky top-0 z-50 transition-all duration-300">
    <div class="container mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <i class="fa fa-comments text-primary text-2xl"></i>
        <h1 class="text-xl font-bold text-primary">LineSpeak</h1>
      </div>
      
      <div class="flex items-center space-x-4">
        <button id="theme-toggle" class="p-2 rounded-full hover:bg-neutral-200 dark:hover:bg-neutral-500 transition-colors">
          <i class="fa fa-moon-o dark:hidden text-neutral-500"></i>
          <i class="fa fa-sun-o hidden dark:inline text-yellow-300"></i>
        </button>
      </div>
    </div>
  </header>

  <main class="container mx-auto px-4 py-8 max-w-4xl">
    <!-- 介绍部分 -->
    <section class="mb-8 text-center">
      <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 text-shadow">English Speaking Practice</h2>
      <p class="text-neutral-500 dark:text-neutral-300 max-w-2xl mx-auto">
        Enter your sentences, each on a new line. Click play buttons to practice, or use the play all feature for continuous practice.
      </p>
    </section>
    
    <!-- 输入区域 -->
    <section class="mb-8 bg-white dark:bg-neutral-600 rounded-xl shadow-md p-6 transition-all duration-300 transform hover:shadow-lg">
      <label for="text-input" class="block text-lg font-medium mb-3 text-neutral-600 dark:text-neutral-200">Enter your sentences (one per line):</label>
      <textarea 
        id="text-input" 
        class="w-full h-40 p-4 border border-neutral-200 dark:border-neutral-500 rounded-lg bg-neutral-50 dark:bg-neutral-700 focus:ring-2 focus:ring-primary focus:border-primary outline-none transition-all resize-none"
        placeholder="Type or paste your English sentences, each on a new line...&#10;&#10;Hello, how are you today?&#10;I am learning English pronunciation.&#10;Could you please repeat that?&#10;Practice makes perfect."
      ></textarea>
      
      <div class="mt-4 flex justify-end">
        <button 
          id="process-btn" 
          class="bg-primary hover:bg-primary/90 text-white px-6 py-2.5 rounded-lg shadow transition-all flex items-center space-x-2 transform hover:scale-[1.02] active:scale-[0.98] mr-3"
        >
          <i class="fa fa-magic"></i>
          <span>Process Sentences</span>
        </button>
      </div>
    </section>
    
    <!-- 结果区域 -->
    <section id="results-section" class="mb-8 hidden">
      <div class="bg-white dark:bg-neutral-600 rounded-xl shadow-md p-6 transition-all duration-300">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold flex items-center">
            <i class="fa fa-list-alt text-primary mr-2"></i>
            Your Sentences
          </h3>
          
          <div class="flex space-x-2">
            <button 
              id="play-all-btn" 
              class="bg-secondary hover:bg-secondary/90 text-white px-4 py-2 rounded-lg shadow transition-all flex items-center space-x-2 text-sm"
            >
              <i class="fa fa-play"></i>
              <span>Play All</span>
            </button>
            <button 
              id="stop-all-btn" 
              class="bg-neutral-400 hover:bg-neutral-500 text-white px-4 py-2 rounded-lg shadow transition-all flex items-center space-x-2 text-sm hidden"
            >
              <i class="fa fa-stop"></i>
              <span>Stop</span>
            </button>
          </div>
        </div>
        
        <!-- 播放进度条 -->
        <div class="progress-bar mb-4">
          <div id="play-progress" class="progress-fill"></div>
        </div>
        
        <div id="sentences-container" class="space-y-4">
          <!-- 句子将在这里动态生成 -->
        </div>
      </div>
    </section>
    
    <!-- 提示卡片 -->
    <section class="bg-primary/5 dark:bg-primary/10 rounded-xl p-5 border border-primary/20 mb-8">
      <div class="flex items-start">
        <i class="fa fa-lightbulb-o text-primary text-xl mt-1 mr-3"></i>
        <div>
          <h4 class="font-semibold text-primary mb-1">Practice Tips</h4>
          <p class="text-sm text-neutral-500 dark:text-neutral-300">
            Use "Play All" to hear the entire text continuously. Listen first, then repeat each sentence. 
            Focus on intonation and stress patterns for natural speaking.
          </p>
        </div>
      </div>
    </section>
  </main>

  <footer class="bg-white dark:bg-neutral-600 py-6 mt-auto">
    <div class="container mx-auto px-4 text-center text-neutral-400 dark:text-neutral-500 text-sm">
      <p>LineSpeak - Improve your English speaking skills effectively</p>
    </div>
  </footer>

  <script>
    // DOM 元素
    const textInput = document.getElementById('text-input');
    const processBtn = document.getElementById('process-btn');
    const resultsSection = document.getElementById('results-section');
    const sentencesContainer = document.getElementById('sentences-container');
    const themeToggle = document.getElementById('theme-toggle');
    const playAllBtn = document.getElementById('play-all-btn');
    const stopAllBtn = document.getElementById('stop-all-btn');
    const playProgress = document.getElementById('play-progress');
    
    // 播放状态变量
    let isPlayingAll = false;
    let currentSentenceIndex = 0;
    let sentencesList = [];
    
    // 深色模式切换
    themeToggle.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    });
    
    // 检查保存的主题偏好
    if (localStorage.getItem('darkMode') === 'true' || 
        (window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('darkMode'))) {
      document.documentElement.classList.add('dark');
    }
    
    // 处理文本并按行断句
    processBtn.addEventListener('click', processText);
    
    // 按Enter+Shift提交
    textInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && e.shiftKey) {
        e.preventDefault();
        processText();
      }
    });
    
    // 播放全部按钮事件
    playAllBtn.addEventListener('click', startPlayAll);
    
    // 停止播放按钮事件
    stopAllBtn.addEventListener('click', stopPlayAll);
    
    // 处理文本函数 - 按行分割
    function processText() {
      const text = textInput.value.trim();
      if (!text) return;
      
      // 按行分割文本，过滤空行
      sentencesList = text.split('\n').filter(line => line.trim() !== '');
      
      // 清空并显示结果区域
      sentencesContainer.innerHTML = '';
      resultsSection.classList.remove('hidden');
      
      // 重置播放进度
      updateProgress(0);
      
      // 平滑滚动到结果区域
      resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      
      // 为每个句子创建元素
      sentencesList.forEach((sentence, index) => {
        const trimmedSentence = sentence.trim();
        if (trimmedSentence) {
          const sentenceElement = createSentenceElement(trimmedSentence, index);
          sentencesContainer.appendChild(sentenceElement);
        }
      });
    }
    
    // 创建句子元素
    function createSentenceElement(sentence, index) {
      const div = document.createElement('div');
      div.className = 'flex items-start p-3 rounded-lg sentence-hover';
      div.dataset.index = index;
      div.id = `sentence-${index}`;
      
      // 播放按钮
      const playBtn = document.createElement('button');
      playBtn.className = 'mr-3 text-primary hover:text-primary/80 transition-colors p-2 rounded-full hover:bg-primary/10 focus:outline-none focus:ring-2 focus:ring-primary/30';
      playBtn.innerHTML = '<i class="fa fa-play"></i>';
      playBtn.dataset.index = index;
      
      // 句子文本
      const textSpan = document.createElement('span');
      textSpan.className = 'flex-1 leading-relaxed';
      textSpan.textContent = sentence;
      
      div.appendChild(playBtn);
      div.appendChild(textSpan);
      
      // 播放按钮点击事件
      playBtn.addEventListener('click', (e) => {
        const idx = parseInt(e.currentTarget.dataset.index);
        stopPlayAll(); // 停止连播
        speakSentence(sentence, div, playBtn, idx, false);
      });
      
      // 点击句子本身也可以播放
      textSpan.addEventListener('click', () => {
        stopPlayAll(); // 停止连播
        speakSentence(sentence, div, playBtn, index, false);
      });
      
      return div;
    }
    
    // 开始连播所有句子
    function startPlayAll() {
      if (sentencesList.length === 0) return;
      
      // 重置状态
      stopPlayAll();
      isPlayingAll = true;
      currentSentenceIndex = 0;
      
      // 更新UI
      playAllBtn.classList.add('hidden');
      stopAllBtn.classList.remove('hidden');
      
      // 开始播放第一个句子
      playNextSentence();
    }
    
    // 播放下一个句子
    function playNextSentence() {
      if (!isPlayingAll || currentSentenceIndex >= sentencesList.length) {
        // 播放结束
        finishPlayAll();
        return;
      }
      
      // 获取当前句子元素
      const sentence = sentencesList[currentSentenceIndex];
      const sentenceElement = document.getElementById(`sentence-${currentSentenceIndex}`);
      if (!sentenceElement) {
        finishPlayAll();
        return;
      }
      
      const playBtn = sentenceElement.querySelector('button');
      
      // 播放当前句子
      speakSentence(sentence, sentenceElement, playBtn, currentSentenceIndex, true);
      
      // 更新进度
      const progress = ((currentSentenceIndex + 1) / sentencesList.length) * 100;
      updateProgress(progress);
      
      // 滚动到当前句子
      sentenceElement.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // 结束连播
    function finishPlayAll() {
      isPlayingAll = false;
      
      // 重置所有句子和按钮状态
      resetAllSentenceStates();
      
      // 更新UI
      playAllBtn.classList.remove('hidden');
      stopAllBtn.classList.add('hidden');
      
      // 重置进度
      updateProgress(0);
    }
    
    // 停止连播
    function stopPlayAll() {
      if (!isPlayingAll) return;
      
      // 停止语音播放
      window.speechSynthesis.cancel();
      
      finishPlayAll();
    }
    
    // 更新进度条
    function updateProgress(percent) {
      playProgress.style.width = `${percent}%`;
    }
    
    // 重置所有句子状态
    function resetAllSentenceStates() {
      document.querySelectorAll('#sentences-container > div').forEach(el => {
        el.classList.remove('sentence-active');
      });
      document.querySelectorAll('#sentences-container button').forEach(btn => {
        btn.innerHTML = '<i class="fa fa-play"></i>';
        btn.classList.remove('text-secondary');
        btn.classList.add('text-primary');
      });
    }
    
    // 语音播放函数
    function speakSentence(text, sentenceElement, button, index, isPartOfSequence) {
      // 停止任何正在播放的语音
      window.speechSynthesis.cancel();
      
      // 重置所有句子和按钮状态
      resetAllSentenceStates();
      
      // 设置当前句子和按钮状态
      sentenceElement.classList.add('sentence-active');
      button.innerHTML = '<i class="fa fa-spinner fa-spin"></i>';
      button.classList.remove('text-primary');
      button.classList.add('text-secondary');
      
      // 创建语音实例
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'en-US';
      utterance.rate = 0.9; // 稍慢一点便于学习
      utterance.pitch = 1;
      utterance.volume = 1;
      
      // 播放结束时的处理
      utterance.onend = () => {
        // 如果是连播模式，继续下一个句子
        if (isPartOfSequence && isPlayingAll && index === currentSentenceIndex) {
          currentSentenceIndex++;
          // 短暂延迟后播放下一句
          setTimeout(playNextSentence, 500);
        } else {
          // 重置当前句子状态
          sentenceElement.classList.remove('sentence-active');
          button.innerHTML = '<i class="fa fa-play"></i>';
          button.classList.remove('text-secondary');
          button.classList.add('text-primary');
        }
      };
      
      // 播放错误处理
      utterance.onerror = (event) => {
        console.error('Speech error:', event.error);
        button.innerHTML = '<i class="fa fa-exclamation-triangle"></i>';
        button.classList.remove('text-secondary');
        button.classList.add('text-red-500');
        
        // 如果是连播模式，继续下一个句子
        if (isPartOfSequence && isPlayingAll) {
          currentSentenceIndex++;
          setTimeout(playNextSentence, 1000);
        } else {
          // 3秒后恢复按钮状态
          setTimeout(() => {
            sentenceElement.classList.remove('sentence-active');
            button.innerHTML = '<i class="fa fa-play"></i>';
            button.classList.remove('text-red-500');
            button.classList.add('text-primary');
          }, 3000);
        }
      };
      
      // 播放语音
      window.speechSynthesis.speak(utterance);
    }
    
    // 示例文本 - 按行分割
    const exampleText = `Good morning/afternoon.
Thanks for having me today.
I’m [Your Name], and I’m applying for the Web Front-End Development job.
First, I have a bachelor’s degree in Geographic Information Systems from Beijing Forestry University.
I studied there from 2010 to 2014.
Since graduating, I’ve worked in front-end development for over 8 years.
And 5 of those years were on financial projects.
My last job was at Shenzhen Farben Information Technology (Guangzhou Branch) from September 2020 to January 2023.
There, I was a Web Front-End Engineer.
My main work was on two HSBC projects: the Wealth Dashboard and Wealth Product Catalog.
Let me tell you a bit about that.
First, I built the front end with React.
I also worked with the back-end team—they used Spring Boot—to make sure data moved smoothly between front and back.
Second, I set up automated tests.
I used Jest for unit tests, and even made coverage reports for them.
I used Testcafe for E2E tests too.
Then I got all these tests running on Jenkins.
This made regression testing faster, and the system more reliable and easier to maintain.
Third, I helped with small back-end tasks.
For example, I developed simple APIs, maintained them, and wrote unit tests for back-end code with Karate/JUnit.
Before Faben, I worked at Pactera Jinxin and South Digital.
Those jobs let me get really good at Vue, Angular, and TypeScript.
I also worked on projects like GF Securities’ customer relationship systems and GIS-based tax analysis tools back then.
Overall, I’m skilled in HTML, JS, CSS, React, Vue, Angular, TypeScript, and webpack.
I’m good at writing code that’s easy to reuse and maintain—this is done using Flux architecture.
I also know how to meet the strict standards of the financial industry.
I’m excited to bring these skills to your team.
Thanks!`;
    
    // 页面加载时设置示例文本并自动处理
    window.addEventListener('load', () => {
      textInput.value = exampleText;
      processText();
    });
  </script>
</body>
</html>
